import matplotlib.pyplot as plt
import pandas as pd
import seaborn as sns
import numpy as np
%matplotlib inline

from sklearn import datasets 
data = datasets.load_boston()
data
df = pd.DataFrame(data.data,columns=data.feature_names)
df
df["price"]=data.target
df
sns.heatmap(df.corr(), annot=True)
sns.scatterplot(df.LSTAT, df.price)
sns.scatterplot(df.RM, df.price)
from sklearn.model_selection import train_test_split
x = pd.DataFrame(np.c_[df.LSTAT, df.RM], columns=['LSTAT', 'RM'])
y = df.price
x
X_train, X_test, Y_train, Y_test = train_test_split(x,y, test_size=0.2, random_state=5)
from sklearn.linear_model import LinearRegression
model = LinearRegression()
model.fit(X_train, Y_train)
y_pred = model.predict(X_test)
from sklearn.metrics import mean_squared_error
from sklearn.metrics import r2_score
rmse = np.sqrt(mean_squared_error(Y_test, y_pred))
r2 = r2_score(Y_test, y_pred)
print('RMSE is: {}'.format(rmse))
print('R2  Score is: {}'.format(r2))
sample_data = [[6.89, 9.99]]
price = model.predict(sample_data)
print("Selling price for the house is ${:,.2f}".format(price[0]))
price[0]